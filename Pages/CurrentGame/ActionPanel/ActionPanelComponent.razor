@using Transdim.DomainModel.GameComponents;

@inject Transdim.Service.IGameComponentFactory GameComponentFactory;
@inject Transdim.Service.IGameStateService GameStateService;

    <div class="row">
        <GameComponentIcon onclick="@(() => PerformAction(powerActionComponent))" gameComponent="@powerActionComponent"></GameComponentIcon>
    </div>


@functions {
    private IGameComponent powerActionComponent;

    private Game game;

    protected override void OnInit()
    {
        powerActionComponent = GameComponentFactory.GetById(GameComponentIdentifier.PowerAction);
    }

    private void PerformAction(IGameComponent gameComponent)
    {
        game = GameStateService.GetGame();

        game.GameActions.Add(new GameAction
        {
            Player = game.ActivePlayer,
            Points = 0,
            // Todo: log using logservice so you don't need to be consistant about your wording. Maybe the action itself contains all the necessary information?
            LogText = $"{game.ActivePlayer.FactionIdentifier} took action {gameComponent.GameComponentIdentifier}"
        }) ;

        GameStateService.UpdateGame(game);
    }
}