@using Transdim.DomainModel.GameComponents;

@inject IModalService ModalService;
@inject Transdim.Service.IGameStateService GameStateService;
@inject Transdim.Utilities.UiQueueExecutor UiQueueExecutor;

<GameComponentIcon onclick="@(() => ChoosePowerAction(GameComponents.PowerActionTwoOre))" gameComponent="@GameComponents.PowerActionTwoOre"></GameComponentIcon>
<GameComponentIcon onclick="@(() => ChoosePowerAction(GameComponents.PowerActionQicPointsForPlanets))" gameComponent="@GameComponents.PowerActionQicPointsForPlanets"></GameComponentIcon>

@functions {
    public void ChoosePowerAction(IGameComponent gameComponent)
    {
        var game = GameStateService.GetGame();

        if (gameComponent.Identifier == GameComponentIdentifier.PowerActionQicPointsForPlanets)
        {
            UiQueueExecutor.Add(typeof(PointsModal));
            UiQueueExecutor.ExecuteQueue();
        }
        else
        {
            game = GameStateService.GetGame();

            game.GameActions.Add(new GameAction
            {
                Player = game.ActivePlayer,
                Points = 0,
                // Todo: log using logservice so you don't need to be consistant about your wording. Maybe the action itself contains all the necessary information?
                LogText = $"{game.ActivePlayer.FactionIdentifier} took action {gameComponent.Identifier}"
            });

            GameStateService.UpdateGame(game);
        }

    }

}